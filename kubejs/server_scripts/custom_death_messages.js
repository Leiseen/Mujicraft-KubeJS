// è‡ªå®šä¹‰ç©å®¶æ­»äº¡ä¿¡æ¯
// ä½œè€…ï¼šç¥¥ç‹
// ç‰ˆæœ¬ï¼š1.4

// å®šä¹‰éœ€è¦è‡ªå®šä¹‰æ­»äº¡ä¿¡æ¯çš„ç©å®¶åˆ—è¡¨
const CUSTOM_DEATH_PLAYERS = ['ç¥¥ç‹', 'Sakik0_Togawa_']; // å¯ä»¥æ·»åŠ æ›´å¤šç©å®¶å

// è‡ªå®šä¹‰æ­»äº¡ä¿¡æ¯åˆ—è¡¨ï¼ˆé»‘è‰²å¹½é»˜é£æ ¼ï¼‰
const DEATH_MESSAGES = [
    'ç¬¨æ‹™è€Œç—›è‹¦åœ°æ­»äº†',
    'ä»¥ä¸€ç§æå…¶å°´å°¬çš„å§¿åŠ¿æ­»å»äº†',
    'æ­»å¾—æ¯«æ— å°Šä¸¥',
    'ä½“éªŒäº†ä¸€æ¬¡å¤±è´¥çš„é‡ç”Ÿ',
    'è¯æ˜äº†äººç±»çš„è„†å¼±æ€§',
    'æˆåŠŸåœ°æŠŠè‡ªå·±ç©æ­»äº†',
    'ç”¨ç”Ÿå‘½è¯ é‡Šäº†ä»€ä¹ˆå«èœ',
    'æ­»å› ï¼šæŠ€ä¸å¦‚äºº',
    'æ­»å¾—ç›¸å½“æœ‰è‰ºæœ¯æ„Ÿ',
    'ä¼˜é›…åœ°é€€å‡ºäº†æ¸¸æˆ',
    'ä»¥æœ€å¿«çš„é€Ÿåº¦å¥”å‘é‡ç”Ÿç‚¹',
    'å®Œæˆäº†ä¸€æ¬¡ä¸å¤ªæˆåŠŸçš„ç”Ÿå­˜å°è¯•',
    'æ­»å¾—å¾ˆæœ‰åˆ›æ„',
    'ç”¨å®é™…è¡ŒåŠ¨è¯æ˜äº†å¢¨è²å®šå¾‹',
    'ä½“é¢åœ°ç»“æŸäº†è¿™ä¸€åˆ‡',
    'æ­»å› ï¼šå¯¹ä¸–ç•Œè®¤çŸ¥ä¸è¶³',
    'ä»¥ä¸€ç§æ•™ç§‘ä¹¦èˆ¬çš„æ–¹å¼æ­»å»',
    'æˆä¸ºäº†è‡ªç„¶é€‰æ‹©çš„ç‰ºç‰²å“',
    'æ­»å¾—æ¯«æ— æ‚¬å¿µ',
    'å®Œæˆäº†ä¸€æ¬¡å¤±è´¥çš„ç”Ÿå‘½å®éªŒ'
];

console.info('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•')
console.info('ğŸ’€ è‡ªå®šä¹‰æ­»äº¡æ¶ˆæ¯ç³»ç»Ÿ V1.4')
console.info('ğŸ‘¤  ç›‘æ§ç©å®¶: ' + CUSTOM_DEATH_PLAYERS.join(', '))
console.info('ğŸ“  æ¶ˆæ¯åº“: ' + DEATH_MESSAGES.length + ' æ¡é»‘è‰²å¹½é»˜é£æ ¼æ¶ˆæ¯')
console.info('ğŸ²  éšæœºé€‰æ‹©: æ¯æ¬¡æ­»äº¡éšæœºæ˜¾ç¤ºä¸€æ¡')
console.info('â±ï¸  å»¶è¿Ÿå‘é€: 2 tick (é¿å…ä¸åŸç‰ˆæ¶ˆæ¯å†²çª)')
console.info('âœ…  çŠ¶æ€: å·²æˆåŠŸåŠ è½½')
console.info('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•')

// ç›‘å¬ç©å®¶æ­»äº¡äº‹ä»¶
EntityEvents.death(event => {
    try {
        let deadEntity = event.entity;
        let gameLevel = event.level;
        
        // æ£€æŸ¥æ˜¯å¦æ˜¯ç©å®¶
        if (!deadEntity || !deadEntity.isPlayer()) {
            return;
        }
        
        let playerName = deadEntity.username;
        
        // æ£€æŸ¥æ˜¯å¦æ˜¯ç›®æ ‡ç©å®¶
        if (!CUSTOM_DEATH_PLAYERS.includes(playerName)) {
            return;
        }
        
        // éšæœºé€‰æ‹©ä¸€æ¡æ­»äº¡ä¿¡æ¯
        let randomMessage = DEATH_MESSAGES[Math.floor(Math.random() * DEATH_MESSAGES.length)];
        let fullMessage = `${playerName}${randomMessage}`;
        
        // å»¶è¿Ÿå‘é€æ¶ˆæ¯ï¼ˆåœ¨åŸç‰ˆæ¶ˆæ¯ä¹‹åï¼‰
        gameLevel.server.scheduleInTicks(2, () => {
            gameLevel.server.tell(Text.red(fullMessage));
        });
        
    } catch (error) {
        console.error(`[è‡ªå®šä¹‰æ­»äº¡æ¶ˆæ¯] é”™è¯¯: ${error}`);
    }
});
